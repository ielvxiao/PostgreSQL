# PostgreSQL与MySQL


## 1. 自身特性
**"我认为 MySQL 属于 Thin Database，而 Oracle 和 PostgreSQL 属于 Thick Database。"**
<p>&emsp;&emsp;Thin Database 的概念在于轻数据库重应用。换句话说，就是数据库只做为数据的存储，只提供简单的查询访问。而复杂的业务逻辑前移到应用服务器端来完成。</p>
<p>&emsp;&emsp;MySQL 数据库自身的特性并不十分丰富，例如 innoDB 存储引擎只提供索引组织表形式的数据存储格式，某种程度上限制了它的使用场景。对于触发器和存储过程的支持较弱，并不建议使用。应用的 CRUD 操作尽量通过主键进行，虽然支持二级索引，但通过二级索引操作会有性能损失。在进行关系型数据库中必不可少的表关联操作时，只支持 Nested Loops 关联方法，缺少对  sort merge join 和 hash join 的支持。当关联表超过2张时，MySQL 的优化器有时生成的执行计划不优，造成性能下降。</p>

<p>&emsp;&emsp;也正因为如此，我们制定了针对 MySQL 的开发规范，例如表的大小不要超过多大，尽量书写简单查询，通过主键来访问数据，不要写超过2张表相互关联的 SQL 等。MySQL 更加适合业务逻辑简单的 OLTP 应用。</p>
<p>&emsp;&emsp;而对于 PostgreSQL 来说，无论业务逻辑简单还是复杂，OLTP 还是 OLAP 负载，PostgreSQL 都可以支持，也都有很成熟的产品，很多著名的 OLAP 数据库产品例如 Greenplum、AWS 的 Redshift 等都是基于 PostgreSQL 开发的。PostgreSQL 的查询优化器非常强大，而且对于三种表关联方法 Nested Loops，Sort-Merge Join 和 Hash Join 全部支持，对于复杂的 SQL 语句优化起来也不是问题，而这正是保险行业进行业务逻辑处理需要的特性。</p>
&emsp;&emsp;PostgreSQL 还提供了强大的数据库内部 function 支持，而且可以用多种语言编写，对于复杂业务逻辑计算以及大数据量访问完全可以在数据库本地化实现，大大减少了网络交互成本，从而整体提升应用性能。

&emsp;&emsp;因此，也有人说 PostgreSQL 不止是一个数据库，更是一个强大的开发平台，足见其功能之丰富。

## 2. 知乎摘录
>作者：方圆
链接：https://www.zhihu.com/question/20010554/answer/15863274
来源：知乎
著作权归作者所有，转载请联系作者获得授权。

一、PostgreSQL 的稳定性极强， Innodb 等引擎在崩溃、断电之类的灾难场景下抗打击能力有了长足进步，然而很多 MySQL 用户都遇到过Server级的数据库丢失的场景——mysql系统库是MyISAM的，相比之下，PG数据库这方面要好一些。

二、任何系统都有它的性能极限，在高并发读写，负载逼近极限下，PG的性能指标仍可以维持双曲线甚至对数曲线，到顶峰之后不再下降，而 MySQL 明显出现一个波峰后下滑（5.5版本之后，在企业级版本中有个插件可以改善很多，不过需要付费）。

三、PG 多年来在 GIS 领域处于优势地位，因为它有丰富的几何类型，实际上不止几何类型，PG有大量字典、数组、bitmap 等数据类型，相比之下mysql就差很多，instagram就是因为PG的空间数据库扩展POSTGIS远远强于MYSQL的my spatial而采用PGSQL的。

四、PG 的“无锁定”特性非常突出，甚至包括 vacuum 这样的整理数据空间的操作，这个和PGSQL的MVCC实现有关系。

五、PG 的可以使用函数和条件索引，这使得PG数据库的调优非常灵活，mysql就没有这个功能，条件索引在web应用中很重要。

六、PG有极其强悍的 SQL 编程能力（9.x 图灵完备，支持递归！），有非常丰富的统计函数和统计语法支持，比如分析函数（ORACLE的叫法，PG里叫window函数），还可以用多种语言来写存储过程，对于R的支持也很好。这一点上MYSQL就差的很远，很多分析功能都不支持，腾讯内部数据存储主要是MYSQL，但是数据分析主要是HADOOP+PGSQL（听李元佳说过，但是没有验证过）。

七、PG 的有多种集群架构可以选择，plproxy 可以支持语句级的镜像或分片，slony 可以进行字段级的同步设置，standby 可以构建WAL文件级或流式的读写分离集群，同步频率和集群策略调整方便，操作非常简单。

八、一般关系型数据库的字符串有限定长度8k左右，无限长 TEXT 类型的功能受限，只能作为外部大数据访问。而 PG 的 TEXT 类型可以直接访问，SQL语法内置正则表达式，可以索引，还可以全文检索，或使用xml xpath。用PG的话，文档数据库都可以省了。

九，对于WEB应用来说，复制的特性很重要，mysql到现在也是异步复制，pgsql可以做到同步，异步，半同步复制。还有mysql的同步是基于binlog复制，类似oracle golden gate,是基于stream的复制，做到同步很困难，这种方式更加适合异地复制，pgsql的复制基于wal，可以做到同步复制。同时，pgsql还提供stream复制。

十，pgsql对于numa架构的支持比mysql强一些，比MYSQL对于读的性能更好一些，pgsql提交可以完全异步，而mysql的内存表不够实用（因为表锁的原因）

### 最后说一下我感觉 PG 不如 MySQL 的地方。
第一，MySQL有一些实用的运维支持，如 slow-query.log ，这个pg肯定可以定制出来，但是如果可以配置使用就更好了。

第二是mysql的innodb引擎，可以充分优化利用系统所有内存，超大内存下PG对内存使用的不那么充分，

第三点，MySQL的复制可以用多级从库，但是在9.2之前，PGSQL不能用从库带从库。

第四点，从测试结果上看，mysql 5.5的性能提升很大，单机性能强于pgsql，5.6应该会强更多.

第五点，对于web应用来说,mysql 5.6 的内置MC API功能很好用，PGSQL差一些。

另外一些：

pgsql和mysql都是背后有商业公司，而且都不是一个公司。大部分开发者，都是拿工资的。
说mysql的执行速度比pgsql快很多是不对的，速度接近，而且很多时候取决于你的配置。
对于存储过程，函数，视图之类的功能，现在两个数据库都可以支持了。
另外多线程架构和多进程架构之间没有绝对的好坏，oracle在unix上是多进程架构，在windows上是多线程架构。
很多pg应用也是24/7的应用，比如skype. 最近几个版本VACUUM基本不影响PGSQL 运行，8.0之后的PGSQL不需要cygwin就可以在windows上运行。

至于说对于事务的支持，mysql和pgsql都没有问题。